@startuml Admin Platform Management
!theme plain

title Wajba - Admin Platform Management Sequence Diagram

actor Admin
participant "Admin Portal" as Portal
participant "Supabase Auth" as Auth
participant "Supabase DB" as DB

Admin -> Portal: Login
Portal -> Auth: signInWithPassword()
Auth --> Portal: Session Token
Portal --> Admin: Show Dashboard

== User Management ==

Admin -> Portal: Navigate to Users
Portal -> DB: SELECT * FROM users
DB --> Portal: Users List
Portal --> Admin: Display Users

alt Filter by Role
    Admin -> Portal: Select Role
    Portal -> DB: SELECT * WHERE role = ?
    DB --> Portal: Filtered Users
    Portal --> Admin: Display Results
else Delete User
    Admin -> Portal: Delete User
    Portal --> Admin: Confirm?
    Admin -> Portal: Confirm
    Portal -> DB: DELETE FROM users
    DB --> Portal: Success
    Portal --> Admin: User Deleted
end

== Restaurant Management ==

Admin -> Portal: Navigate to Restaurants
Portal -> DB: SELECT * FROM restaurants
DB --> Portal: Restaurants List
Portal --> Admin: Display Restaurants

Admin -> Portal: Approve Restaurant
Portal -> DB: UPDATE restaurants SET is_active = true
DB --> Portal: Updated
Portal --> Admin: Restaurant Approved

== Analytics ==

Admin -> Portal: View Analytics
Portal -> DB: SELECT COUNT(*) FROM orders
Portal -> DB: SELECT SUM(total_amount) FROM orders
Portal -> DB: SELECT COUNT(*) FROM users
DB --> Portal: Statistics
Portal --> Admin: Display Dashboard

Admin -> Portal: Select Period
Portal -> DB: SELECT * WHERE created_at BETWEEN ? AND ?
DB --> Portal: Period Data
Portal --> Admin: Update Charts

== Promotions ==

Admin -> Portal: Navigate to Promotions
Portal -> DB: SELECT * FROM promotions
DB --> Portal: Promotions List
Portal --> Admin: Display Promotions

alt Create Promotion
    Admin -> Portal: Create Promotion
    Portal -> DB: INSERT INTO promotions
    DB --> Portal: Created
    Portal --> Admin: Success
else Toggle Status
    Admin -> Portal: Toggle Status
    Portal -> DB: UPDATE promotions SET is_active = ?
    DB --> Portal: Updated
    Portal --> Admin: Status Changed
end

@enduml
